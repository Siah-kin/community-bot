<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Metrics - Bonzi Research</title>
    <meta name="description" content="Live system parameters and metrics. Free tier available, premium tiers for DAO members.">
    <link rel="canonical" href="https://siah-kin.github.io/community-bot/research/">
    <link rel="icon" href="../bonzi-logo.png" type="image/png">
    <link rel="stylesheet" href="../css/bonzi-design.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --purple: #7C3AED;
            --purple-light: #A78BFA;
            --purple-dark: #5B21B6;
            --white: #FFFFFF;
            --black: #0A0A0A;
            --gray: #71717A;
            --gray-light: #F4F4F5;
            --gold: #D4AF37;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--white);
            color: var(--black);
            line-height: 1.6;
        }
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding: 20px 40px;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--gray-light);
        }
        .nav-logo {
            font-weight: 700;
            font-size: 18px;
            color: var(--black);
            text-decoration: none;
        }
        .nav-links { display: flex; gap: 24px; align-items: center; }
        .nav-primary, .nav-secondary { display: flex; align-items: center; gap: 24px; }
        .nav-primary a {
            color: var(--black);
            text-decoration: none;
            font-size: 14px;
            font-weight: 600;
            text-transform: lowercase;
        }
        .nav-secondary a {
            color: var(--gray);
            text-decoration: none;
            font-size: 12px;
            text-transform: lowercase;
        }
        .nav-links a:hover { color: var(--purple); }
        .nav-divider { color: var(--gray-light); font-size: 16px; margin: 0 8px; }
        .nav-links a.active { color: var(--purple); }

        .hero {
            padding: 140px 40px 40px;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }
        .hero h1 {
            font-size: 48px;
            margin-bottom: 16px;
        }
        .hero p {
            font-size: 18px;
            color: var(--gray);
        }

        /* Tier badges */
        .tier-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 48px 0 24px;
            padding: 0 40px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }
        .tier-badge {
            font-size: 11px;
            font-weight: 700;
            padding: 6px 12px;
            border-radius: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .tier-badge.free { background: #10B981; color: white; }
        .tier-badge.dao-1 { background: var(--purple); color: white; }
        .tier-badge.dao-2 { background: var(--gold); color: var(--black); }
        .tier-title {
            font-size: 20px;
            font-weight: 600;
        }
        .tier-requirement {
            font-size: 13px;
            color: var(--gray);
            margin-left: auto;
        }

        /* Dashboard */
        .dashboard {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 40px 80px;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }
        .metric-card {
            background: var(--gray-light);
            border-radius: 12px;
            padding: 24px;
            position: relative;
        }
        .metric-card h3 {
            font-size: 14px;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .badge {
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
        }
        .badge.live { background: #10B981; color: white; }
        .badge.cached { background: #F59E0B; color: white; }
        .metric-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            font-size: 14px;
        }
        .metric-item:last-child { border-bottom: none; }
        .metric-key { color: var(--gray); }
        .metric-value { font-weight: 600; font-family: monospace; }
        .metric-value.green { color: #10B981; }
        .metric-value.gold { color: var(--gold); }

        /* Locked tier overlay */
        .tier-section {
            position: relative;
        }
        .tier-section.locked .metrics-grid {
            filter: blur(8px);
            pointer-events: none;
            user-select: none;
        }
        .tier-section.locked::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.8) 100%);
            pointer-events: none;
        }
        .unlock-prompt {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            background: var(--white);
            border: 2px solid var(--purple);
            border-radius: 16px;
            padding: 32px 48px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(124, 58, 237, 0.2);
        }
        .unlock-prompt.tier-2 {
            border-color: var(--gold);
            box-shadow: 0 20px 60px rgba(212, 175, 55, 0.2);
        }
        .unlock-prompt h3 {
            font-size: 20px;
            margin-bottom: 8px;
        }
        .unlock-prompt p {
            color: var(--gray);
            font-size: 14px;
            margin-bottom: 20px;
        }
        .unlock-btn {
            background: var(--purple);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s, transform 0.2s;
        }
        .unlock-btn:hover {
            background: var(--purple-dark);
            transform: translateY(-1px);
        }
        .unlock-btn.tier-2 {
            background: var(--gold);
            color: var(--black);
        }
        .unlock-btn.tier-2:hover {
            background: #c4a030;
        }

        .last-updated {
            text-align: center;
            color: var(--gray);
            font-size: 12px;
            margin-top: 40px;
        }

        /* Status indicator */
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 6px;
        }
        .status-dot.green { background: #10B981; }
        .status-dot.yellow { background: #F59E0B; }
        .status-dot.red { background: #EF4444; }

        /* Dark mode */
        body.dark-mode {
            background: var(--black);
            color: var(--white);
        }
        body.dark-mode .hero h1 { color: var(--white); }
        body.dark-mode .metric-card {
            background: #1F1F23;
            border: 1px solid rgba(255,255,255,0.08);
        }
        body.dark-mode .metric-item {
            border-bottom-color: rgba(255,255,255,0.05);
        }
        body.dark-mode .metric-key { color: #A1A1AA; }
        body.dark-mode .metric-value { color: var(--white); }
        body.dark-mode .unlock-prompt {
            background: #1F1F23;
            border-color: var(--purple);
        }
        body.dark-mode .unlock-prompt.tier-2 {
            border-color: var(--gold);
        }
        body.dark-mode .tier-section.locked::after {
            background: linear-gradient(180deg, rgba(10,10,10,0) 0%, rgba(10,10,10,0.9) 100%);
        }

        @media (max-width: 768px) {
            .hero { padding: 120px 20px 30px; }
            .hero h1 { font-size: 32px; }
            .dashboard { padding: 0 20px 60px; }
            .tier-header { padding: 0 20px; flex-wrap: wrap; }
            .tier-requirement { margin-left: 0; margin-top: 8px; width: 100%; }
            .unlock-prompt { padding: 24px; margin: 0 20px; }
        }

        /* ═══════════════════════════════════════════════════════════════ */
        /* TRADING VOLUME PROOF SECTION                                    */
        /* ═══════════════════════════════════════════════════════════════ */

        .proof-section {
            max-width: 1000px;
            margin: 0 auto 60px;
            padding: 0 40px;
        }
        .proof-section .section-number {
            font-size: 12px;
            font-weight: 600;
            color: var(--purple);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 8px;
        }
        .proof-section h2 {
            font-size: 32px;
            margin-bottom: 24px;
            line-height: 1.2;
        }
        .proof-section .prose {
            font-size: 17px;
            line-height: 1.8;
            color: var(--gray);
            margin-bottom: 32px;
            max-width: 720px;
        }
        .proof-section .prose strong {
            color: var(--black);
        }
        body.dark-mode .proof-section .prose strong {
            color: var(--white);
        }
        .proof-section .prose .define {
            color: var(--purple);
            font-style: italic;
        }
        .proof-section .manifesto-link {
            color: var(--purple);
            text-decoration: none;
            border-bottom: 1px solid var(--purple-light);
        }
        .proof-section .manifesto-link:hover {
            border-bottom-color: var(--purple);
        }

        /* Volume Charts */
        .volume-charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-bottom: 48px;
        }
        @media (max-width: 768px) {
            .volume-charts { grid-template-columns: 1fr; }
        }
        .chart-card {
            background: var(--gray-light);
            border-radius: 12px;
            padding: 24px;
        }
        body.dark-mode .chart-card {
            background: #1F1F23;
            border: 1px solid rgba(255,255,255,0.08);
        }
        .chart-card h3 {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .chart-card .chart-subtitle {
            font-size: 12px;
            color: var(--gray);
            margin-bottom: 20px;
        }
        .chart-card .chart-highlight {
            font-size: 28px;
            font-weight: 700;
            font-family: 'Space Mono', monospace;
            margin-bottom: 4px;
        }
        .chart-card .chart-highlight.purple { color: var(--purple); }
        .chart-card .chart-highlight.gold { color: var(--gold); }

        /* CSS-only Bar Chart */
        .bar-chart {
            display: flex;
            align-items: flex-end;
            gap: 4px;
            height: 120px;
            margin-bottom: 16px;
            padding-top: 8px;
        }
        .bar-chart .bar {
            flex: 1;
            background: linear-gradient(180deg, var(--purple) 0%, var(--purple-dark) 100%);
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: height 0.3s ease;
            min-height: 4px;
        }
        .bar-chart .bar:hover {
            background: var(--purple-light);
        }
        .bar-chart .bar::after {
            content: attr(data-label);
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 9px;
            color: var(--gray);
            white-space: nowrap;
        }
        .bar-chart .bar.highlight {
            background: linear-gradient(180deg, var(--gold) 0%, #c4a030 100%);
        }

        /* Distribution Correlation Line */
        .correlation-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-top: 1px solid rgba(0,0,0,0.05);
            font-size: 13px;
        }
        body.dark-mode .correlation-row {
            border-top-color: rgba(255,255,255,0.05);
        }
        .correlation-row .label { color: var(--gray); }
        .correlation-row .value {
            font-weight: 600;
            font-family: 'Space Mono', monospace;
        }
        .correlation-row .value.green { color: #10B981; }

        /* Three-Box Regulatory System */
        .three-box-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 40px 0;
        }
        @media (max-width: 900px) {
            .three-box-grid { grid-template-columns: 1fr; }
        }
        .three-box {
            padding: 24px;
            border-radius: 12px;
            border-left: 4px solid;
        }
        .three-box.technical {
            background: rgba(59, 130, 246, 0.08);
            border-left-color: #3B82F6;
        }
        .three-box.feature {
            background: rgba(124, 58, 237, 0.08);
            border-left-color: var(--purple);
        }
        .three-box.advantage {
            background: rgba(16, 185, 129, 0.08);
            border-left-color: #10B981;
        }
        body.dark-mode .three-box.technical { background: rgba(59, 130, 246, 0.12); }
        body.dark-mode .three-box.feature { background: rgba(124, 58, 237, 0.12); }
        body.dark-mode .three-box.advantage { background: rgba(16, 185, 129, 0.12); }
        .three-box .box-label {
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        .three-box.technical .box-label { color: #3B82F6; }
        .three-box.feature .box-label { color: var(--purple); }
        .three-box.advantage .box-label { color: #10B981; }
        .three-box h4 {
            font-size: 16px;
            margin-bottom: 8px;
        }
        .three-box p {
            font-size: 14px;
            color: var(--gray);
            line-height: 1.6;
        }

        /* Comparison Stats Row */
        .stats-comparison {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 32px 0;
            padding: 24px;
            background: var(--gray-light);
            border-radius: 12px;
        }
        body.dark-mode .stats-comparison {
            background: #1F1F23;
        }
        @media (max-width: 768px) {
            .stats-comparison { grid-template-columns: 1fr; }
        }
        .stats-comparison .stat {
            text-align: center;
        }
        .stats-comparison .stat-value {
            font-size: 32px;
            font-weight: 700;
            font-family: 'Space Mono', monospace;
            color: var(--purple);
        }
        .stats-comparison .stat-label {
            font-size: 12px;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 4px;
        }

        /* ROI Proof Card */
        .roi-proof {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(124, 58, 237, 0.1) 100%);
            border: 2px solid #10B981;
            border-radius: 16px;
            padding: 32px;
            margin: 48px 0;
            position: relative;
            overflow: hidden;
        }
        body.dark-mode .roi-proof {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(124, 58, 237, 0.15) 100%);
        }
        .roi-proof::before {
            content: '✓';
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 120px;
            opacity: 0.1;
            color: #10B981;
        }
        .roi-proof .roi-label {
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #10B981;
            margin-bottom: 12px;
        }
        .roi-proof h3 {
            font-size: 28px;
            margin-bottom: 16px;
            line-height: 1.3;
        }
        .roi-proof .roi-highlight {
            font-size: 48px;
            font-weight: 700;
            font-family: 'Space Mono', monospace;
            color: #10B981;
            margin: 24px 0;
        }
        .roi-proof .roi-subtext {
            font-size: 16px;
            color: var(--gray);
            margin-bottom: 8px;
        }
        .roi-proof .roi-distinction {
            font-size: 15px;
            line-height: 1.7;
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid rgba(16, 185, 129, 0.3);
        }
        .roi-proof .roi-distinction strong {
            color: #10B981;
        }
        .roi-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            margin-top: 24px;
        }
        @media (max-width: 768px) {
            .roi-grid { grid-template-columns: 1fr; }
            .roi-proof .roi-highlight { font-size: 36px; }
        }
        .roi-grid .roi-stat {
            text-align: center;
            padding: 16px;
            background: rgba(255,255,255,0.5);
            border-radius: 8px;
        }
        body.dark-mode .roi-grid .roi-stat {
            background: rgba(0,0,0,0.3);
        }
        .roi-grid .roi-stat-value {
            font-size: 24px;
            font-weight: 700;
            font-family: 'Space Mono', monospace;
            color: var(--purple);
        }
        .roi-grid .roi-stat-label {
            font-size: 11px;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 4px;
        }

        /* Contract Links */
        .contract-links {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-top: 24px;
        }
        .contract-link {
            font-size: 12px;
            color: var(--gray);
            text-decoration: none;
            padding: 8px 16px;
            border: 1px solid var(--gray-light);
            border-radius: 6px;
            font-family: 'Space Mono', monospace;
            transition: all 0.2s;
        }
        .contract-link:hover {
            border-color: var(--purple);
            color: var(--purple);
        }
        body.dark-mode .contract-link {
            border-color: rgba(255,255,255,0.1);
        }
    </style>
</head>
<body>
    <nav>
        <a href="../" class="nav-logo">bonzi</a>

        <!-- Ethervista-style Nav Links -->
        <div class="nav-links">
            <div class="nav-dropdown">
                <a href="../features.html" class="nav-link" data-i18n="nav.features">features</a>
                <div class="nav-dropdown-menu">
                    <a href="../features.html#adaptive-agents">Adaptive Agents</a>
                    <a href="../features.html#ask-earn">Ask & Earn</a>
                    <a href="../features.html#sybil">Sybil Detection</a>
                    <a href="../features.html#raid">Raid & Earn</a>
                </div>
            </div>
            <div class="nav-dropdown">
                <a href="../manual/" class="nav-link" data-i18n="nav.manual">manual</a>
                <div class="nav-dropdown-menu">
                    <a href="../manual/#quickstart">Quick Start</a>
                    <a href="../manual/#commands">Commands</a>
                    <a href="../manual/#staking">Staking Guide</a>
                    <a href="../manual/#admin">Admin Tools</a>
                </div>
            </div>
            <div class="nav-dropdown">
                <a href="../faq.html" class="nav-link" data-i18n="nav.manifesto">manifesto</a>
                <div class="nav-dropdown-menu">
                    <a href="../faq.html#why-purple">Why Purple?</a>
                    <a href="../faq.html#market">Market Validation</a>
                    <a href="../faq.html#ai-hype">AI Hype Check</a>
                    <a href="../faq.html#skeptics">For Skeptics</a>
                </div>
            </div>
            <div class="nav-dropdown">
                <a href="../economics/" class="nav-link" data-i18n="nav.economics">economics</a>
                <div class="nav-dropdown-menu">
                    <a href="../economics/#ethervista">Ethervista</a>
                    <a href="../economics/#euler-model">Euler Model</a>
                    <a href="../economics/#hardstake">Hardstake</a>
                    <a href="../economics/#anti-rug">Anti-Rug</a>
                </div>
            </div>
            <div class="nav-divider"></div>
            <a href="./" class="nav-link gated active" data-i18n="nav.metrics">metrics</a>
            <a href="../dao/" class="nav-link gated" data-i18n="nav.dao">dao</a>
            <div class="nav-divider"></div>
            <a href="../index.html?contact=1" class="nav-link" data-i18n="nav.contact">contact</a>
        </div>

        <!-- Right: Lang, Theme, Connect -->
        <div class="nav-right">
            <select class="nav-lang-select" id="lang-select" aria-label="Language">
                <option value="en">EN</option>
                <option value="pt">PT</option>
                <option value="zh">ZH</option>
                <option value="tr">TR</option>
                <option value="ru">RU</option>
                <option value="fr">FR</option>
            </select>
            <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
            </button>
            <button class="nav-connect-btn" id="nav-connect-btn" data-i18n="nav.connect">connect</button>
        </div>
    </nav>

    <section class="hero">
        <h1>System Metrics</h1>
        <p>Live parameters and configuration. Three tiers of access based on token holdings.</p>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════════════ -->
    <!-- TRADING VOLUME AS PROOF - Bridge from Manifesto                         -->
    <!-- ═══════════════════════════════════════════════════════════════════════ -->
    <section class="proof-section">
        <span class="section-number">01 • Proof of Mechanics</span>
        <h2>Volume → Fees → Stakers. That's the loop.</h2>

        <p class="prose">
            In the <a href="../faq.html#why-purple" class="manifesto-link">manifesto</a>, we said "staking how it should be." Here's what that means in numbers. The <span class="define">Euler model</span> <span class="define">(a fee accumulator that distributes trading fees to stakers in ETH, not tokens)</span> creates a flywheel: trading volume generates fees, fees flow to stakers, stakers have reason to hold, holding supports liquidity, liquidity enables more trading. <strong>This isn't speculation — it's math.</strong>
        </p>

        <p class="prose">
            Volume dropped 70% in the bear market. Distributions continued. That's the difference between narrative and mechanics. Below: 12 months of trading data from both tokens. The correlation is the proof.
        </p>

        <!-- Volume Charts -->
        <div class="volume-charts">
            <!-- BONZI Chart -->
            <div class="chart-card">
                <h3>$BONZI Monthly Volume <span class="badge live">LIVE</span></h3>
                <p class="chart-subtitle">Ethervista DEX • Contract: 0xd617...cbb86</p>
                <div class="chart-highlight purple">$1.6M+ distributed</div>
                <p class="chart-subtitle">to stakers over 600+ days</p>

                <div class="bar-chart">
                    <div class="bar" style="height: 45%;" data-label="Feb"></div>
                    <div class="bar" style="height: 35%;" data-label="Mar"></div>
                    <div class="bar" style="height: 25%;" data-label="Apr"></div>
                    <div class="bar" style="height: 20%;" data-label="May"></div>
                    <div class="bar" style="height: 15%;" data-label="Jun"></div>
                    <div class="bar" style="height: 18%;" data-label="Jul"></div>
                    <div class="bar" style="height: 22%;" data-label="Aug"></div>
                    <div class="bar" style="height: 40%;" data-label="Sep"></div>
                    <div class="bar highlight" style="height: 95%;" data-label="Oct"></div>
                    <div class="bar highlight" style="height: 100%;" data-label="Nov"></div>
                    <div class="bar" style="height: 65%;" data-label="Dec"></div>
                    <div class="bar" style="height: 55%;" data-label="Jan"></div>
                </div>

                <div class="correlation-row">
                    <span class="label">Fee rate to stakers</span>
                    <span class="value">~3%</span>
                </div>
                <div class="correlation-row">
                    <span class="label">Bear market (lowest)</span>
                    <span class="value">$50k/day</span>
                </div>
                <div class="correlation-row">
                    <span class="label">Bull periods (peak)</span>
                    <span class="value">$1M+/day</span>
                </div>
                <div class="correlation-row">
                    <span class="label">Distributions during bear</span>
                    <span class="value green">Continued ✓</span>
                </div>
            </div>

            <!-- VISTA Chart -->
            <div class="chart-card">
                <h3>$VISTA Monthly Volume <span class="badge live">LIVE</span></h3>
                <p class="chart-subtitle">Ethervista DEX • Contract: 0xc9bc...cbbf</p>
                <div class="chart-highlight gold">Same mechanics</div>
                <p class="chart-subtitle">pattern holds across Euler tokens</p>

                <div class="bar-chart">
                    <div class="bar" style="height: 55%;" data-label="Feb"></div>
                    <div class="bar" style="height: 40%;" data-label="Mar"></div>
                    <div class="bar" style="height: 30%;" data-label="Apr"></div>
                    <div class="bar" style="height: 25%;" data-label="May"></div>
                    <div class="bar" style="height: 20%;" data-label="Jun"></div>
                    <div class="bar" style="height: 22%;" data-label="Jul"></div>
                    <div class="bar" style="height: 28%;" data-label="Aug"></div>
                    <div class="bar highlight" style="height: 85%;" data-label="Sep"></div>
                    <div class="bar highlight" style="height: 100%;" data-label="Oct"></div>
                    <div class="bar highlight" style="height: 90%;" data-label="Nov"></div>
                    <div class="bar" style="height: 60%;" data-label="Dec"></div>
                    <div class="bar" style="height: 50%;" data-label="Jan"></div>
                </div>

                <div class="correlation-row">
                    <span class="label">Fee rate to stakers</span>
                    <span class="value">~5%</span>
                </div>
                <div class="correlation-row">
                    <span class="label">LP hardlock</span>
                    <span class="value">75%</span>
                </div>
                <div class="correlation-row">
                    <span class="label">Team allocation</span>
                    <span class="value green">0%</span>
                </div>
                <div class="correlation-row">
                    <span class="label">Inflation events</span>
                    <span class="value green">0</span>
                </div>
            </div>
        </div>

        <!-- Comparison Stats -->
        <div class="stats-comparison">
            <div class="stat">
                <div class="stat-value">~3-5%</div>
                <div class="stat-label">Volume → Stakers</div>
            </div>
            <div class="stat">
                <div class="stat-value">0%</div>
                <div class="stat-label">Token Inflation</div>
            </div>
            <div class="stat">
                <div class="stat-value">ETH</div>
                <div class="stat-label">Reward Currency</div>
            </div>
        </div>

        <!-- ROI Proof - The Critical Distinction -->
        <div class="roi-proof">
            <span class="roi-label">The Critical Distinction</span>
            <h3>Day-1 stakers have been paid back. They still hold the token.</h3>

            <div class="roi-highlight">100%+ ROI in ETH</div>
            <p class="roi-subtext">For stakers since September 2024</p>

            <div class="roi-grid">
                <div class="roi-stat">
                    <div class="roi-stat-value">600+</div>
                    <div class="roi-stat-label">Days Distributing</div>
                </div>
                <div class="roi-stat">
                    <div class="roi-stat-value">$1.6M+</div>
                    <div class="roi-stat-label">Total ETH Paid</div>
                </div>
                <div class="roi-stat">
                    <div class="roi-stat-value">0</div>
                    <div class="roi-stat-label">Tokens Sold to Profit</div>
                </div>
            </div>

            <p class="roi-distinction">
                <strong>This is why power stakers are still holding.</strong> In every other token, early holders must sell to profit — that's the definition of a Ponzi. Here, the opposite happened: stakers received ETH continuously. Their initial investment paid itself back. The token is still in their wallet. No exit needed. No one left holding the bag.
            </p>
            <p class="roi-distinction">
                <strong>Most tokens:</strong> Buy → Hope price goes up → Sell to someone else → They need someone else to sell to.<br>
                <strong>Euler tokens:</strong> Stake → Receive ETH from trading fees → Investment returns in ETH → Token still held. Loop continues.
            </p>
            <p class="roi-distinction">
                <strong>This is central to DAO vs Ponzi.</strong> In a Ponzi, early holders MUST exit before late holders. Value flows one direction: in → out. In a DAO with Euler mechanics, early holders get paid back AND stay. They buy more because the loop keeps working. Value circulates. No one needs to be the exit liquidity. That's the behavioral proof of sustainable tokenomics.
            </p>
        </div>

        <!-- Regulatory Framing Prose -->
        <p class="prose">
            <strong>Why this matters beyond yield.</strong> The structure has regulatory implications. The <span class="define">Howey test</span> <span class="define">(the SEC's framework for determining if something is a security)</span> asks: "Do profits come from the efforts of others?" Our answer: What others? The code runs. The team can't touch it. Distributions are mathematical, not discretionary.
        </p>

        <!-- Three-Box Regulatory System -->
        <div class="three-box-grid">
            <div class="three-box technical">
                <span class="box-label">Technical • HOW</span>
                <h4>Euler Accumulator</h4>
                <p>Fees are tracked per token via an on-chain accumulator. When you claim, you receive your proportional share of all fees since your last claim. No human decides. No approval needed. Math distributes.</p>
            </div>
            <div class="three-box feature">
                <span class="box-label">Feature • WHAT</span>
                <h4>ETH Rewards, Not Tokens</h4>
                <p>Stakers receive ETH — a commodity, not a project token. No inflation schedule. No emission curve. No dilution. The token is your membership card. The ETH is your share of activity.</p>
            </div>
            <div class="three-box advantage">
                <span class="box-label">Advantage • WHY</span>
                <h4>Utility, Not Security</h4>
                <p>Howey's "efforts of others" prong fails when code distributes and team is absent from the reward mechanism. The token grants access and governance. The ETH comes from trading activity, not team promises.</p>
            </div>
        </div>

        <p class="prose">
            Self-compounding mechanics allow for more creative token ecosystems in a regulatory-sound manner. The reward is ETH. The token possesses utility as an anchor of decision and values — not as a security-behaving money machine. <strong>Verify, don't trust.</strong>
        </p>

        <!-- Contract Links -->
        <div class="contract-links">
            <a href="https://etherscan.io/address/0xd6175692026bcd7cb12a515e39cf0256ef35cb86" target="_blank" class="contract-link">$BONZI: 0xd617...cb86</a>
            <a href="https://etherscan.io/address/0xc9bca88b04581699fab5aa276ccaff7df957cbbf" target="_blank" class="contract-link">$VISTA: 0xc9bc...cbbf</a>
            <a href="https://etherscan.io/address/0x3618158bb8d07111e476f4de28676dff050d1a53" target="_blank" class="contract-link">BONZI Hardstake: 0x3618...1a53</a>
            <a href="https://etherscan.io/address/0xee5a6f8a55b02689138c195031d09bafdc7d278f" target="_blank" class="contract-link">VISTA Hardstake: 0xee5a...278f</a>
        </div>
    </section>

    <div class="dashboard">
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- FREE TIER - Public metrics (no wallet required) -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="tier-header">
            <span class="tier-badge free">FREE</span>
            <span class="tier-title">Public Metrics</span>
            <span class="tier-requirement">No wallet required</span>
        </div>

        <div class="tier-section" id="tier-free">
            <div class="metrics-grid">
                <!-- System Status -->
                <div class="metric-card">
                    <h3>System Status <span class="badge live">LIVE</span></h3>
                    <div class="metric-item">
                        <span class="metric-key"><span class="status-dot green"></span>Bot Status</span>
                        <span class="metric-value green">Online</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Uptime</span>
                        <span class="metric-value">99.7%</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Version</span>
                        <span class="metric-value">v2.4.1</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Last Deploy</span>
                        <span class="metric-value">2h ago</span>
                    </div>
                </div>

                <!-- Community Stats -->
                <div class="metric-card">
                    <h3>Community Stats <span class="badge live">LIVE</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">Total Users</span>
                        <span class="metric-value">12,847</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Active (7d)</span>
                        <span class="metric-value">2,341</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Questions Answered</span>
                        <span class="metric-value">89,432</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Avg Response Time</span>
                        <span class="metric-value">1.2s</span>
                    </div>
                </div>

                <!-- DAO Stats -->
                <div class="metric-card">
                    <h3>DAO Activity <span class="badge live">LIVE</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">Bug Reports</span>
                        <span class="metric-value">347</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">DAO Points Awarded</span>
                        <span class="metric-value">18,920</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Active Testers</span>
                        <span class="metric-value">89</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Bugs Fixed</span>
                        <span class="metric-value">312</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- DAO TIER 1 - Token holder metrics -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="tier-header">
            <span class="tier-badge dao-1">DAO-1</span>
            <span class="tier-title">Intelligence Parameters</span>
            <span class="tier-requirement">1M $BONZI or 500 $VISTA</span>
        </div>

        <div class="tier-section locked" id="tier-1">
            <div class="unlock-prompt">
                <h3>DAO Tier 1</h3>
                <p>Connect wallet with 1M $BONZI or 500 $VISTA</p>
                <button class="unlock-btn" onclick="connectWallet(1)">Connect Wallet</button>
            </div>

            <div class="metrics-grid">
                <!-- Feature Flags -->
                <div class="metric-card">
                    <h3>Feature Flags <span class="badge live">LIVE</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">USE_ORCHESTRATOR_CURATION</span>
                        <span class="metric-value">ON</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">ORCHESTRATOR_ROLLOUT</span>
                        <span class="metric-value">100%</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">SIAH_ENABLE_FREE_CHAT</span>
                        <span class="metric-value">ON</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">ENABLE_NEURAL_RERANK</span>
                        <span class="metric-value">ON</span>
                    </div>
                </div>

                <!-- Token Budgets -->
                <div class="metric-card">
                    <h3>Token Budgets <span class="badge cached">CACHED</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">CONCISE</span>
                        <span class="metric-value">500 tokens</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">MECHANISM</span>
                        <span class="metric-value">700 tokens</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">DETAILED</span>
                        <span class="metric-value">1000 tokens</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">MACRO</span>
                        <span class="metric-value">1200 tokens</span>
                    </div>
                </div>

                <!-- LLM Parameters -->
                <div class="metric-card">
                    <h3>LLM Parameters <span class="badge cached">CACHED</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">Primary Model</span>
                        <span class="metric-value">gpt-4o-mini</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Primary Temp</span>
                        <span class="metric-value">0.7</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Fallback Model</span>
                        <span class="metric-value">gemini-2.5-flash</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Fallback Temp</span>
                        <span class="metric-value">0.9</span>
                    </div>
                </div>

                <!-- Cache & Rate Limits -->
                <div class="metric-card">
                    <h3>Cache & Rate Limits <span class="badge cached">CACHED</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">Response Cache TTL</span>
                        <span class="metric-value">3600s</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Embedding Cache TTL</span>
                        <span class="metric-value">86400s</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Rate Limit (user)</span>
                        <span class="metric-value">30/min</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Rate Limit (group)</span>
                        <span class="metric-value">60/min</span>
                    </div>
                </div>

                <!-- Memory System -->
                <div class="metric-card">
                    <h3>Memory System <span class="badge cached">CACHED</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">Short-term Window</span>
                        <span class="metric-value">10 msgs</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Long-term Limit</span>
                        <span class="metric-value">100 facts</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Decay Rate</span>
                        <span class="metric-value">0.95/day</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Importance Threshold</span>
                        <span class="metric-value">0.3</span>
                    </div>
                </div>

                <!-- Agent Scaling -->
                <div class="metric-card">
                    <h3>Agent Scaling <span class="badge cached">CACHED</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">Max Agents Per Type</span>
                        <span class="metric-value">3</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Max Total Agents</span>
                        <span class="metric-value">10</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Agent Timeout</span>
                        <span class="metric-value">30s</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Retry Attempts</span>
                        <span class="metric-value">3</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- DAO TIER 2 - Premium insights -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="tier-header">
            <span class="tier-badge dao-2">DAO-2</span>
            <span class="tier-title">Cost Analytics & Decision Traces</span>
            <span class="tier-requirement">10M $BONZI or 1,000 $VISTA</span>
        </div>

        <div class="tier-section locked" id="tier-2">
            <div class="unlock-prompt tier-2">
                <h3>DAO Tier 2</h3>
                <p>Connect wallet with 10M $BONZI or 1,000 $VISTA</p>
                <button class="unlock-btn tier-2" onclick="connectWallet(2)">Connect Wallet</button>
            </div>

            <div class="metrics-grid">
                <!-- Cost Breakdown -->
                <div class="metric-card">
                    <h3>Cost Breakdown (24h) <span class="badge live">LIVE</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">OpenAI API</span>
                        <span class="metric-value gold">$47.82</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Gemini API</span>
                        <span class="metric-value gold">$12.40</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Embeddings</span>
                        <span class="metric-value gold">$3.21</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Total (24h)</span>
                        <span class="metric-value gold">$63.43</span>
                    </div>
                </div>

                <!-- Model Usage -->
                <div class="metric-card">
                    <h3>Model Usage (24h) <span class="badge live">LIVE</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">GPT-4o-mini calls</span>
                        <span class="metric-value">8,421</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Gemini calls</span>
                        <span class="metric-value">2,847</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Cache hits</span>
                        <span class="metric-value green">67%</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Avg latency</span>
                        <span class="metric-value">847ms</span>
                    </div>
                </div>

                <!-- Decision Traces -->
                <div class="metric-card">
                    <h3>Router Decisions (24h) <span class="badge live">LIVE</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">RAG queries</span>
                        <span class="metric-value">4,231</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Direct answers</span>
                        <span class="metric-value">3,847</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Escalations</span>
                        <span class="metric-value">127</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Blocked (spam)</span>
                        <span class="metric-value">89</span>
                    </div>
                </div>

                <!-- Error Rates -->
                <div class="metric-card">
                    <h3>Error Rates (24h) <span class="badge live">LIVE</span></h3>
                    <div class="metric-item">
                        <span class="metric-key"><span class="status-dot green"></span>OpenAI errors</span>
                        <span class="metric-value green">0.2%</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key"><span class="status-dot green"></span>Gemini errors</span>
                        <span class="metric-value green">0.4%</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key"><span class="status-dot yellow"></span>RAG failures</span>
                        <span class="metric-value">1.8%</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key"><span class="status-dot green"></span>Timeout rate</span>
                        <span class="metric-value green">0.3%</span>
                    </div>
                </div>

                <!-- Sybil Intelligence -->
                <div class="metric-card">
                    <h3>Sybil Intelligence <span class="badge live">LIVE</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">Flagged accounts (7d)</span>
                        <span class="metric-value">34</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">AI fingerprint detections</span>
                        <span class="metric-value">127</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Temporal clusters</span>
                        <span class="metric-value">8</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Cross-tenant flags</span>
                        <span class="metric-value">12</span>
                    </div>
                </div>

                <!-- Learning Loop -->
                <div class="metric-card">
                    <h3>Learning Loop <span class="badge cached">CACHED</span></h3>
                    <div class="metric-item">
                        <span class="metric-key">Knowledge gaps logged</span>
                        <span class="metric-value">47</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Admin corrections</span>
                        <span class="metric-value">23</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Auto-promoted FAQs</span>
                        <span class="metric-value">12</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-key">Feedback loop active</span>
                        <span class="metric-value green">Yes</span>
                    </div>
                </div>
            </div>
        </div>

        <p class="last-updated">Last updated: <span id="lastUpdate">-</span></p>
    </div>

    <!-- Sound Toggle + Hint -->
    <div class="sound-hint" id="sound-hint">
        <span class="emoji">💜</span>
        <span class="emoji">🤫</span>
        <span class="arrow">▼</span>
    </div>
    <button class="sound-toggle muted" id="sound-toggle" aria-label="Toggle sound">
        <svg class="sound-on" viewBox="0 0 24 24" fill="currentColor">
            <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
        </svg>
        <svg class="sound-off" viewBox="0 0 24 24" fill="currentColor">
            <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
        </svg>
    </button>
    <audio id="bg-music" preload="auto"></audio>

    <!-- Web3 Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.9.0/dist/ethers.umd.min.js"></script>

    <script>
        // Token Contracts (Ethereum mainnet)
        const BONZI_TOKEN = '0xd6175692026bcd7cb12a515e39cf0256ef35cb86';  // VERIFIED
        const VISTA_TOKEN = '0xc9bca88b04581699fab5aa276ccaff7df957cbbf';  // VERIFIED
        const ETHEREUM_CHAIN_ID = '0x1'; // Mainnet

        // Hardstake Pools (for staked tokens)
        const BONZI_HARDSTAKE = '0x3618158bb8d07111e476f4de28676dff050d1a53';
        const VISTA_HARDSTAKE = '0xee5a6f8a55b02689138c195031d09bafdc7d278f';

        // LP Pairs (for liquidity providers)
        const BONZI_LP = '0x970cf9b7346fbaea0588f03356a104100eb675e2';
        const VISTA_LP = '0xfdd05552f1377aa488afed744c8024358af02041';

        // Tier thresholds (wallet + staked counts, LP = auto Tier 1)
        const TIER_1_BONZI = 1000000;   // 1M $BONZI
        const TIER_1_VISTA = 500;       // OR 500 $VISTA
        const TIER_2_BONZI = 10000000;  // 10M $BONZI
        const TIER_2_VISTA = 1000;      // OR 1000 $VISTA

        // State
        let userTier = 0;
        let userBonzi = 0;
        let userVista = 0;

        // Check wallet and determine tier on load
        async function checkAuth() {
            const savedWallet = localStorage.getItem('bonzi_wallet_address');
            const savedTimestamp = localStorage.getItem('bonzi_auth_timestamp');
            const savedTier = localStorage.getItem('bonzi_user_tier');

            // Auth expires after 24 hours
            if (savedWallet && savedTimestamp && savedTier) {
                const age = Date.now() - parseInt(savedTimestamp);
                if (age < 24 * 60 * 60 * 1000) {
                    userTier = parseInt(savedTier);
                    updateTierUI();
                    return;
                }
            }

            // Clear expired auth
            localStorage.removeItem('bonzi_wallet_address');
            localStorage.removeItem('bonzi_auth_timestamp');
            localStorage.removeItem('bonzi_user_tier');
        }

        // Update UI based on tier
        function updateTierUI() {
            const tier1Section = document.getElementById('tier-1');
            const tier2Section = document.getElementById('tier-2');

            if (userTier >= 1) {
                tier1Section.classList.remove('locked');
                tier1Section.querySelector('.unlock-prompt')?.remove();
            }
            if (userTier >= 2) {
                tier2Section.classList.remove('locked');
                tier2Section.querySelector('.unlock-prompt')?.remove();
            }
        }

        // Connect wallet and verify tier
        async function connectWallet(requiredTier = 1, buttonEl = null) {
            // Get button from parameter, event, or fallback to nav button
            const btn = buttonEl || (typeof event !== 'undefined' ? event.target : document.getElementById('nav-connect-btn'));
            if (!btn) {
                console.error('No button element found');
                return;
            }
            const originalText = btn.textContent;

            // Timeout helper - 45 second max wait
            const withTimeout = (promise, ms = 45000) => {
                return Promise.race([
                    promise,
                    new Promise((_, reject) => setTimeout(() => reject(new Error('Connection timed out. Please try again.')), ms))
                ]);
            };

            try {
                if (typeof window.ethereum === 'undefined') {
                    alert('Please install MetaMask or another Web3 wallet');
                    return;
                }

                btn.textContent = 'Connecting...';
                btn.disabled = true;

                // Request wallet connection with timeout
                const accounts = await withTimeout(window.ethereum.request({
                    method: 'eth_requestAccounts'
                }));

                if (!accounts || accounts.length === 0) {
                    throw new Error('No accounts found');
                }

                // Check if on Ethereum mainnet
                const chainId = await window.ethereum.request({ method: 'eth_chainId' });
                if (chainId !== ETHEREUM_CHAIN_ID) {
                    btn.textContent = 'Switch to Ethereum...';
                    try {
                        await window.ethereum.request({
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: ETHEREUM_CHAIN_ID }]
                        });
                    } catch (switchError) {
                        throw new Error('Please switch to Ethereum mainnet');
                    }
                }

                const address = accounts[0];
                btn.textContent = 'Checking tokens...';

                // Verify token balances (wallet + staked + LP)
                const provider = new ethers.BrowserProvider(window.ethereum);
                const erc20Abi = ['function balanceOf(address) view returns (uint256)', 'function decimals() view returns (uint8)'];
                const hardstakeAbi = ['function getStakerInfo(address) view returns (uint256 amountStaked, uint256 timeLeftToUnlock, uint256 currentShare)'];

                const bonziContract = new ethers.Contract(BONZI_TOKEN, erc20Abi, provider);
                const vistaContract = new ethers.Contract(VISTA_TOKEN, erc20Abi, provider);
                const bonziHardstake = new ethers.Contract(BONZI_HARDSTAKE, hardstakeAbi, provider);
                const vistaHardstake = new ethers.Contract(VISTA_HARDSTAKE, hardstakeAbi, provider);
                const bonziLp = new ethers.Contract(BONZI_LP, erc20Abi, provider);
                const vistaLp = new ethers.Contract(VISTA_LP, erc20Abi, provider);

                const [
                    bonziRaw, bonziDecimals,
                    vistaRaw, vistaDecimals,
                    bonziStakeInfo, vistaStakeInfo,
                    bonziLpRaw, vistaLpRaw
                ] = await Promise.all([
                    bonziContract.balanceOf(address),
                    bonziContract.decimals(),
                    vistaContract.balanceOf(address),
                    vistaContract.decimals(),
                    bonziHardstake.getStakerInfo(address).catch(() => [0n, 0n, 0n]),
                    vistaHardstake.getStakerInfo(address).catch(() => [0n, 0n, 0n]),
                    bonziLp.balanceOf(address).catch(() => 0n),
                    vistaLp.balanceOf(address).catch(() => 0n)
                ]);

                // Calculate total holdings (wallet + staked)
                const bonziWallet = parseFloat(ethers.formatUnits(bonziRaw, bonziDecimals));
                const bonziStaked = parseFloat(ethers.formatUnits(bonziStakeInfo[0], bonziDecimals));
                userBonzi = bonziWallet + bonziStaked;

                const vistaWallet = parseFloat(ethers.formatUnits(vistaRaw, vistaDecimals));
                const vistaStaked = parseFloat(ethers.formatUnits(vistaStakeInfo[0], vistaDecimals));
                userVista = vistaWallet + vistaStaked;

                const hasLp = bonziLpRaw > 0n || vistaLpRaw > 0n;

                // Determine tier (LP holders get Tier 1 minimum)
                if (userBonzi >= TIER_2_BONZI || userVista >= TIER_2_VISTA) {
                    userTier = 2;
                } else if (userBonzi >= TIER_1_BONZI || userVista >= TIER_1_VISTA || hasLp) {
                    userTier = 1;
                } else {
                    userTier = 0;
                }

                // Check if user qualifies for requested tier
                if (userTier < requiredTier) {
                    const reqBonzi = requiredTier === 2 ? TIER_2_BONZI : TIER_1_BONZI;
                    const reqVista = requiredTier === 2 ? TIER_2_VISTA : TIER_1_VISTA;
                    throw new Error(
                        `Tier ${requiredTier} requires:\n• ${reqBonzi.toLocaleString()} $BONZI (you have ${userBonzi.toLocaleString()})\n• OR ${reqVista.toLocaleString()} $VISTA (you have ${userVista.toFixed(2)})`
                    );
                }

                // Store auth with tier
                localStorage.setItem('bonzi_wallet_address', address);
                localStorage.setItem('bonzi_auth_timestamp', Date.now().toString());
                localStorage.setItem('bonzi_user_tier', userTier.toString());

                btn.textContent = 'Verified ✓';
                setTimeout(() => {
                    updateTierUI();
                }, 500);

            } catch (error) {
                console.error('Wallet connection failed:', error);
                alert(error.message || 'Failed to connect wallet. Please try again.');
                btn.textContent = originalText;
                btn.disabled = false;
            }
        }

        // Update timestamp
        document.getElementById('lastUpdate').textContent = new Date().toLocaleString();

        checkAuth();

        // Theme toggle
        const themeToggle = document.getElementById('theme-toggle');
        const savedTheme = localStorage.getItem('bonzi_theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
        }
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            localStorage.setItem('bonzi_theme', isDark ? 'dark' : 'light');
        });

        // Sound toggle
        const soundToggle = document.getElementById('sound-toggle');
        const soundHint = document.getElementById('sound-hint');
        const bgMusic = document.getElementById('bg-music');

        const musicState = localStorage.getItem('bonzi_music_state');
        const musicTime = parseFloat(localStorage.getItem('bonzi_music_time') || '0');

        if (musicState === 'playing') {
            bgMusic.src = '../moby-god-moving.mp3';
            bgMusic.currentTime = musicTime;
            bgMusic.play().then(() => {
                soundToggle.classList.remove('muted');
                if (soundHint) soundHint.style.display = 'none';
            }).catch(() => {});
        }

        soundToggle.addEventListener('click', () => {
            if (bgMusic.paused) {
                if (!bgMusic.src || bgMusic.src === '') {
                    bgMusic.src = '../moby-god-moving.mp3';
                }
                bgMusic.play();
                soundToggle.classList.remove('muted');
                localStorage.setItem('bonzi_music_state', 'playing');
                if (soundHint) soundHint.style.display = 'none';
            } else {
                bgMusic.pause();
                soundToggle.classList.add('muted');
                localStorage.setItem('bonzi_music_state', 'paused');
            }
        });

        setInterval(() => {
            if (!bgMusic.paused) {
                localStorage.setItem('bonzi_music_time', bgMusic.currentTime.toString());
            }
        }, 1000);

        if (soundHint) {
            setTimeout(() => {
                soundHint.style.opacity = '0';
                setTimeout(() => soundHint.style.display = 'none', 500);
            }, 5000);
        }

        // Nav Connect Button Handler
        (function() {
            const navBtn = document.getElementById('nav-connect-btn');
            if (!navBtn) return;
            function truncateAddress(addr) { return addr.slice(0, 6) + '...' + addr.slice(-4); }
            function updateButtonState() {
                const savedWallet = localStorage.getItem('bonzi_wallet_address');
                const savedTimestamp = localStorage.getItem('bonzi_auth_timestamp');
                if (savedWallet && savedTimestamp) {
                    const age = Date.now() - parseInt(savedTimestamp);
                    if (age < 24 * 60 * 60 * 1000) {
                        navBtn.textContent = truncateAddress(savedWallet);
                        navBtn.classList.add('connected');
                        return true;
                    }
                }
                return false;
            }
            updateButtonState();
            navBtn.addEventListener('click', () => {
                if (!updateButtonState()) connectWallet(1, navBtn);
            });
        })();
    </script>
</body>
</html>
