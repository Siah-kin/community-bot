<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Features Deep Dive - Bonzi AI Community Management</title>
    <meta name="description" content="Why we built each feature the way we did. The engineering decisions behind AI community management.">
    <link rel="canonical" href="https://siah-kin.github.io/community-bot/features.html">
    <link rel="icon" href="bonzi-logo.png" type="image/png">
    <link rel="stylesheet" href="css/bonzi-design.css">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --purple: #7C3AED;
            --purple-light: #A78BFA;
            --purple-dark: #5B21B6;
            --white: #FFFFFF;
            --black: #0A0A0A;
            --gray: #71717A;
            --gray-light: #F4F4F5;
            --gold: #d4af37;
        }
        html { scroll-behavior: smooth; overflow-x: hidden; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--white);
            color: var(--black);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Ethervista-style Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 56px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 24px;
        }
        .nav-logo {
            font-weight: 700;
            font-size: 18px;
            color: var(--black);
            text-decoration: none;
            letter-spacing: -0.5px;
        }
        .nav-links {
            display: flex;
            gap: 32px;
            align-items: center;
        }
        .nav-link {
            color: rgba(0, 0, 0, 0.6);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: color 0.2s;
        }
        .nav-link:hover { color: var(--black); }
        .nav-link.active { color: var(--black); font-weight: 600; }
        .nav-divider {
            width: 1px;
            height: 16px;
            background: rgba(0, 0, 0, 0.15);
        }
        .nav-link.gated::after {
            content: ' \1F512';
            font-size: 10px;
            opacity: 0.5;
        }
        /* Nav dropdown styles */
        .nav-dropdown { position: relative; }
        .nav-dropdown > .nav-link { cursor: pointer; }
        .nav-dropdown-menu {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 8px 0;
            min-width: 160px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            z-index: 200;
            margin-top: 8px;
        }
        .nav-dropdown:hover .nav-dropdown-menu,
        .nav-dropdown.active .nav-dropdown-menu { opacity: 1; visibility: visible; }
        .nav-dropdown-menu a {
            display: block;
            padding: 8px 16px;
            color: rgba(0, 0, 0, 0.7);
            text-decoration: none;
            font-size: 13px;
            transition: background 0.15s, color 0.15s, transform 0.2s ease-out, opacity 0.2s ease-out;
            transform: translateY(-8px);
            opacity: 0;
        }
        .nav-dropdown:hover .nav-dropdown-menu a,
        .nav-dropdown.active .nav-dropdown-menu a { transform: translateY(0); opacity: 1; }
        .nav-dropdown-menu a:nth-child(1) { transition-delay: 0s; }
        .nav-dropdown-menu a:nth-child(2) { transition-delay: 0.03s; }
        .nav-dropdown-menu a:nth-child(3) { transition-delay: 0.06s; }
        .nav-dropdown-menu a:nth-child(4) { transition-delay: 0.09s; }
        .nav-dropdown-menu a:hover { background: rgba(0, 0, 0, 0.05); color: #000; transform: translateX(4px); }
        .nav-right {
            display: flex;
            gap: 16px;
            align-items: center;
        }
        .nav-lang-select {
            background: transparent;
            border: 1px solid rgba(0, 0, 0, 0.15);
            border-radius: 6px;
            padding: 6px 10px;
            font-size: 12px;
            color: rgba(0, 0, 0, 0.7);
            cursor: pointer;
        }
        .theme-toggle {
            background: transparent;
            border: none;
            padding: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            border-radius: 6px;
        }
        .theme-toggle:hover { background: rgba(0, 0, 0, 0.05); }
        .theme-toggle svg { width: 18px; height: 18px; stroke: rgba(0, 0, 0, 0.7); }
        .theme-toggle .icon-sun { display: none; }
        body.dark-mode .theme-toggle .icon-moon { display: none; }
        body.dark-mode .theme-toggle .icon-sun { display: block; }

        /* Dark Mode Styles */
        body.dark-mode {
            background: #0A0A0A;
            color: #FFFFFF;
        }
        body.dark-mode nav {
            background: rgba(10, 10, 10, 0.95);
            border-bottom-color: rgba(255, 255, 255, 0.08);
        }
        body.dark-mode .nav-logo { color: #FFFFFF; }
        body.dark-mode .nav-link { color: rgba(255, 255, 255, 0.6); }
        body.dark-mode .nav-link:hover { color: #FFFFFF; }
        body.dark-mode .nav-divider { background: rgba(255, 255, 255, 0.15); }
        body.dark-mode .nav-dropdown-menu {
            background: rgba(20, 20, 20, 0.98);
            border-color: rgba(255, 255, 255, 0.1);
        }
        body.dark-mode .nav-dropdown-menu a { color: rgba(255, 255, 255, 0.7); }
        body.dark-mode .nav-dropdown-menu a:hover { color: #FFFFFF; background: rgba(255, 255, 255, 0.05); }
        body.dark-mode .theme-toggle:hover { background: rgba(255, 255, 255, 0.1); }
        body.dark-mode .theme-toggle svg { stroke: rgba(255, 255, 255, 0.7); }
        body.dark-mode .hero p { color: #A1A1AA; }
        body.dark-mode .feature-section { border-top-color: #27272A; }
        body.dark-mode .feature-section:nth-child(even) { background: #1F1F23; }
        body.dark-mode .tagline { color: #A1A1AA; }
        body.dark-mode .problem-block { background: #2D1F1F; border-left-color: #EF4444; }
        body.dark-mode .problem-block p { color: #FCA5A5; }
        body.dark-mode .solution-block { background: #1F2D1F; border-left-color: #10B981; }
        body.dark-mode .solution-block p { color: #6EE7B7; }
        body.dark-mode .tech-section { background: #1F1F23; }
        body.dark-mode .flow-diagram { background: #18181B; border-color: #27272A; }
        body.dark-mode .flow-step { background: #27272A; color: #FFFFFF; }
        body.dark-mode .metrics-section { background: #1F1F23; }
        body.dark-mode .stat-block { background: #27272A; }
        body.dark-mode .stat-label { color: #A1A1AA; }
        body.dark-mode .stat-detail { color: #71717A; }
        body.dark-mode .edge-case { background: #27272A; }
        body.dark-mode .edge-case .case-trigger { color: #A78BFA; }
        body.dark-mode .code-sample { background: #18181B; color: #E4E4E7; }
        body.dark-mode .block-label { color: #A1A1AA; }
        body.dark-mode .nav-lang-select { background: rgba(255, 255, 255, 0.1); color: #FFFFFF; border-color: rgba(255, 255, 255, 0.2); }

        .nav-connect-btn {
            background: linear-gradient(135deg, #d4c084 0%, #a89050 100%);
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            color: #0a0a0a;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .nav-connect-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(212, 192, 132, 0.3);
        }
        .nav-connect-btn.connected {
            background: #7C3AED;
            color: #FFFFFF;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 12px;
            letter-spacing: 0.5px;
        }
        .nav-connect-btn.connected:hover {
            background: #5B21B6;
        }
        @media (max-width: 768px) {
            nav { padding: 0 16px; }
            .nav-links { gap: 16px; }
            .nav-link { font-size: 13px; }
        }
        @media (max-width: 600px) {
            .nav-links { gap: 12px; }
            .nav-link { font-size: 12px; }
            .nav-logo { font-size: 16px; }
            .nav-lang-select { display: none; }
        }

        /* Hero */
        .hero {
            padding: 160px 40px 80px;
            max-width: 900px;
            margin: 0 auto;
        }
        .hero-label {
            color: var(--purple);
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 16px;
        }
        .hero h1 {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 24px;
            line-height: 1.1;
        }
        .hero p {
            font-size: 20px;
            color: var(--gray);
            max-width: 600px;
        }

        /* Feature Sections */
        .feature-section {
            padding: 80px 40px;
            max-width: 900px;
            margin: 0 auto;
            border-top: 1px solid var(--gray-light);
        }
        .feature-section:nth-child(even) {
            background: var(--gray-light);
            max-width: 100%;
            padding-left: calc((100% - 820px) / 2);
            padding-right: calc((100% - 820px) / 2);
        }
        .feature-header {
            display: flex;
            align-items: flex-start;
            gap: 24px;
            margin-bottom: 40px;
        }
        .feature-icon {
            width: 64px;
            height: 64px;
            background: var(--purple);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .feature-icon svg {
            width: 32px;
            height: 32px;
            color: white;
            stroke: white;
        }
        .feature-title h2 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .feature-title .tagline {
            color: var(--gray);
            font-size: 18px;
        }

        /* Status badges */
        .status-badge {
            font-size: 10px;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .status-badge.live {
            background: #10B981;
            color: white;
        }
        .status-badge.beta {
            background: #F59E0B;
            color: white;
        }
        .status-badge.coming {
            background: #6366F1;
            color: white;
        }

        /* Content blocks */
        .problem-block, .solution-block, .engineering-block {
            margin-bottom: 40px;
        }
        .block-label {
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 12px;
        }
        .problem-block .block-label { color: #DC2626; }
        .solution-block .block-label { color: #16A34A; }
        .engineering-block .block-label { color: var(--purple); }

        .block-content {
            font-size: 16px;
            color: var(--black);
        }
        .block-content p { margin-bottom: 16px; }
        .block-content ul {
            margin-left: 24px;
            margin-bottom: 16px;
        }
        .block-content li { margin-bottom: 8px; }
        .block-content strong { color: var(--purple); }

        /* Code/technical blocks */
        .tech-detail {
            background: var(--black);
            color: #E4E4E7;
            padding: 24px;
            border-radius: 12px;
            font-family: 'SF Mono', 'Monaco', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin: 24px 0;
        }
        .tech-detail .comment { color: #6B7280; }
        .tech-detail .highlight { color: #A78BFA; }

        /* Comparison table */
        .comparison {
            width: 100%;
            border-collapse: collapse;
            margin: 24px 0;
        }
        .comparison th, .comparison td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--gray-light);
        }
        .comparison th {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--gray);
        }
        .comparison td:first-child { font-weight: 600; }
        .comparison .bad { color: #DC2626; }
        .comparison .good { color: #16A34A; }

        /* Manual cross-link */
        .manual-link {
            margin-top: 32px;
            padding: 16px 20px;
            background: rgba(124, 58, 237, 0.08);
            border-left: 3px solid var(--purple);
            border-radius: 0 8px 8px 0;
        }
        .manual-link a {
            color: var(--purple);
            text-decoration: none;
            font-weight: 600;
        }
        .manual-link a:hover {
            text-decoration: underline;
        }

        /* Flow diagram */
        .flow-diagram {
            background: var(--gray-light);
            padding: 32px;
            border-radius: 16px;
            margin: 24px 0;
            font-family: 'SF Mono', monospace;
            font-size: 14px;
            line-height: 1.8;
            white-space: pre;
            overflow-x: auto;
        }

        /* CTA */
        .cta-section {
            padding: 80px 40px;
            text-align: center;
            background: var(--purple);
            color: white;
        }
        .cta-section h2 {
            font-size: 36px;
            margin-bottom: 16px;
        }
        .cta-section p {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 32px;
        }
        .cta-btn {
            display: inline-block;
            padding: 16px 32px;
            background: white;
            color: var(--purple);
            text-decoration: none;
            font-weight: 600;
            border-radius: 8px;
            transition: transform 0.2s;
        }
        .cta-btn:hover { transform: translateY(-2px); }

        /* Footer */
        footer {
            padding: 40px;
            text-align: center;
            color: var(--gray);
            font-size: 14px;
        }
        footer a { color: var(--gold); text-decoration: none; }
        footer a:hover { color: var(--purple); }

        /* Hamburger menu */
        .hamburger {
            display: none;
            flex-direction: column;
            gap: 5px;
            cursor: pointer;
            padding: 8px;
            z-index: 101;
        }
        .hamburger span {
            width: 24px;
            height: 2px;
            background: var(--black);
            transition: all 0.3s;
        }
        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }
        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(5px, -5px);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero { padding: 120px 20px 60px; }
            .hero h1 { font-size: 28px; }
            .hero p { font-size: 16px; }
            .feature-section { padding: 60px 20px; }
            .feature-section:nth-child(even) {
                padding-left: 20px;
                padding-right: 20px;
            }
            .feature-header { flex-direction: column; }
            .feature-title h2 { font-size: 24px; }
            .feature-title .tagline { font-size: 16px; }
            nav { padding: 16px 20px; }
            .hamburger { display: flex; }
            .nav-links {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: var(--white);
                flex-direction: column;
                justify-content: center;
                align-items: center;
                gap: 24px;
                z-index: 100;
            }
            .nav-links.active {
                display: flex;
            }
            .nav-links a {
                font-size: 20px;
                font-weight: 600;
            }
            .flow-diagram {
                font-size: 11px;
                padding: 16px;
            }
            .comparison th, .comparison td {
                padding: 10px 8px;
                font-size: 13px;
            }
            .tech-detail {
                font-size: 11px;
                padding: 16px;
            }
            .cta-section { padding: 60px 20px; }
            .cta-section h2 { font-size: 28px; }
        }
    </style>
</head>
<body>
    <nav>
        <a href="./" class="nav-logo">bonzi</a>

        <!-- Ethervista-style Nav Links -->
        <div class="nav-links">
            <div class="nav-dropdown">
                <a href="features.html" class="nav-link active" data-i18n="nav.features">features</a>
                <div class="nav-dropdown-menu">
                    <a href="features.html#adaptive-agents">Adaptive Agents</a>
                    <a href="features.html#ask-earn">Ask & Earn</a>
                    <a href="features.html#sybil">Sybil Detection</a>
                    <a href="features.html#raid">Raid & Earn</a>
                </div>
            </div>
            <div class="nav-dropdown">
                <a href="manual/" class="nav-link" data-i18n="nav.manual">manual</a>
                <div class="nav-dropdown-menu">
                    <a href="manual/#quickstart">Quick Start</a>
                    <a href="manual/#commands">Commands</a>
                    <a href="manual/#staking">Staking Guide</a>
                    <a href="manual/#admin">Admin Tools</a>
                </div>
            </div>
            <div class="nav-dropdown">
                <a href="faq.html" class="nav-link" data-i18n="nav.manifesto">manifesto</a>
                <div class="nav-dropdown-menu">
                    <a href="faq.html#why-purple">Why Purple?</a>
                    <a href="faq.html#market">Market Validation</a>
                    <a href="faq.html#ai-hype">AI Hype Check</a>
                    <a href="faq.html#skeptics">For Skeptics</a>
                </div>
            </div>
            <div class="nav-dropdown">
                <a href="economics/" class="nav-link" data-i18n="nav.economics">economics</a>
                <div class="nav-dropdown-menu">
                    <a href="economics/#ethervista">Ethervista</a>
                    <a href="economics/#euler-model">Euler Model</a>
                    <a href="economics/#hardstake">Hardstake</a>
                    <a href="economics/#anti-rug">Anti-Rug</a>
                </div>
            </div>
            <div class="nav-divider"></div>
            <a href="research/" class="nav-link gated" data-i18n="nav.metrics">metrics</a>
            <a href="dao/" class="nav-link gated" data-i18n="nav.dao">dao</a>
            <div class="nav-divider"></div>
            <a href="index.html?contact=1" class="nav-link" data-i18n="nav.contact">contact</a>
        </div>

        <!-- Right: Lang, Theme, Connect -->
        <div class="nav-right">
            <select class="nav-lang-select" id="lang-select" aria-label="Language">
                <option value="en">EN</option>
                <option value="pt">PT</option>
                <option value="zh">ZH</option>
                <option value="tr">TR</option>
                <option value="ru">RU</option>
                <option value="fr">FR</option>
            </select>
            <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
            </button>
            <button class="nav-connect-btn" id="nav-connect-btn" data-i18n="nav.connect">connect</button>
        </div>
    </nav>

    <section class="hero">
        <div class="hero-label">Engineering Deep Dive</div>
        <h1>Why we built each feature the way we did.</h1>
        <p>Every feature solves a specific problem we saw destroying crypto communities. Here's the thinking behind each one.</p>
    </section>

    <!-- ADAPTIVE AGENTS - CORE PHILOSOPHY -->
    <section class="feature-section" id="adaptive-agents" style="background: linear-gradient(135deg, #7C3AED08 0%, #7C3AED15 100%); border-top: 3px solid var(--purple);">
        <div class="feature-header">
            <div class="feature-icon" style="background: linear-gradient(135deg, var(--purple) 0%, var(--purple-dark) 100%);">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/><circle cx="12" cy="12" r="4"/></svg>
            </div>
            <div class="feature-title">
                <h2>Adaptive Agents <span class="status-badge live">Live</span></h2>
                <div class="tagline">Not static bots. Learning systems that evolve with your community.</div>
            </div>
        </div>

        <div class="problem-block">
            <div class="block-label">The Problem</div>
            <div class="block-content">
                <p><strong>Static bots are dead-ends.</strong> You upload docs once. Bot answers from those docs forever. New products launch? Bot doesn't know. FAQ changes? Bot gives stale answers. Users ask questions the bot can't answer? They escalate to humans.</p>
                <p>The result: founders become human FAQ machines. Every knowledge gap funnels to the same 2-3 people. They become bottlenecks. They burn out.</p>
            </div>
        </div>

        <div class="solution-block">
            <div class="block-label">Our Solution</div>
            <div class="block-content">
                <p><strong>Adaptive agents that curate communication.</strong> The system learns from every interaction:</p>
                <ul>
                    <li><strong>Gap Detection</strong> - When the bot can't answer, that gap is logged. Admins see what users are asking that isn't documented.</li>
                    <li><strong>Real-time Updates</strong> - Admins add knowledge. The very next user asking that question gets the answer. No redeploy needed.</li>
                    <li><strong>Pattern Recognition</strong> - Same question asked 10 times? System surfaces it for FAQ promotion. One-off edge cases stay in RAG.</li>
                    <li><strong>Closed-Loop Learning</strong> - User feedback, admin corrections, and engagement signals all feed back into the system.</li>
                </ul>
            </div>
        </div>

        <div class="engineering-block">
            <div class="block-label">Why This Changes Everything</div>
            <div class="block-content">
                <p><strong>The feedback loop that eliminates bottlenecks:</strong></p>

                <div class="flow-diagram">
User asks question
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Bot answers OR logs gap            â”‚
â”‚  Either way: human not needed       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gap Dashboard                      â”‚
â”‚  Admin sees: "12 users asked about  â”‚
â”‚  OREBIT fees, no answer exists"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin adds knowledge (30 seconds)  â”‚
â”‚  "OREBIT fees go to OREBIT stakers" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
âœ… Next user gets instant answer
   No code change. No redeploy.
                </div>

                <p><strong>Static vs Adaptive:</strong></p>

                <table class="comparison">
                    <tr>
                        <th>Dimension</th>
                        <th>Static Bot</th>
                        <th>Adaptive Agent</th>
                    </tr>
                    <tr>
                        <td>Knowledge updates</td>
                        <td class="bad">Redeploy required</td>
                        <td class="good">Real-time, no code</td>
                    </tr>
                    <tr>
                        <td>Unknown questions</td>
                        <td class="bad">Escalate to human</td>
                        <td class="good">Log gap, dead-end cleanly</td>
                    </tr>
                    <tr>
                        <td>Learning</td>
                        <td class="bad">Never improves</td>
                        <td class="good">Every interaction teaches</td>
                    </tr>
                    <tr>
                        <td>Founder load</td>
                        <td class="bad">Constant FAQ duty</td>
                        <td class="good">Add knowledge once, done</td>
                    </tr>
                </table>

                <p><strong>Real example from today:</strong> Users asked about Foundry token fee mechanics. Bot didn't know. Gap logged. Admin added the answer. Now anyone asking "Do OREBIT fees go to VISTA stakers?" gets: <em>"No. Each Foundry token's fees go only to that token's stakers."</em> Question answered. No human escalation. Loop closed.</p>

                <p>This is the core philosophy behind every feature below. We don't build static tools. We build systems that get smarter as your community uses them.</p>
            </div>
        </div>
    </section>

    <!-- ASK & EARN -->
    <section class="feature-section" id="ask-earn">
        <div class="feature-header">
            <div class="feature-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"/></svg>
            </div>
            <div class="feature-title">
                <h2>Ask & Earn <span class="status-badge live">Live</span></h2>
                <div class="tagline">AI-scored questions. Curiosity beats farming.</div>
            </div>
        </div>

        <div class="problem-block">
            <div class="block-label">The Problem</div>
            <div class="block-content">
                <p>Traditional point systems reward <strong>quantity over quality</strong>. Users spam "gm" and copy-paste questions to farm points. Real contributors get drowned out by noise.</p>
                <p>Manual moderation doesn't scale. Moderators burn out reviewing the same low-effort content. Communities become ghost towns of farmers waiting for airdrops.</p>
            </div>
        </div>

        <div class="solution-block">
            <div class="block-label">Our Solution</div>
            <div class="block-content">
                <p>AI scores every question on three dimensions:</p>
                <ul>
                    <li><strong>Depth</strong> - Does it require thought to answer? Single-word answers = low score.</li>
                    <li><strong>Novelty</strong> - Has this been asked before? Semantic similarity check against history.</li>
                    <li><strong>Cooperation</strong> - Does it help others learn? Questions that benefit the community score higher.</li>
                </ul>
                <p>Result: 1-10 points per question. Farmers get 1-2 pts for spam. Curious users get 7-10 pts for genuine questions.</p>
            </div>
        </div>

        <div class="engineering-block">
            <div class="block-label">Why We Engineered It This Way</div>
            <div class="block-content">
                <p><strong>Semantic similarity, not keyword matching.</strong> Farmers would game keyword rules instantly. By embedding questions and comparing vectors, we detect rephrased duplicates that humans would miss.</p>
                <p><strong>Cooperation metrics.</strong> We track if a question leads to follow-up discussion. Questions that spark conversation get retroactive score boosts. This incentivizes questions that actually help the community.</p>

                <div class="tech-detail">
<span class="comment"># Simplified scoring logic</span>
score = 0
score += depth_score(question)      <span class="comment"># 0-4 pts</span>
score += novelty_score(question)    <span class="comment"># 0-3 pts (penalize duplicates)</span>
score += cooperation_score(thread)  <span class="comment"># 0-3 pts (retroactive)</span>

<span class="comment"># Anti-gaming: score decays if user's questions never get answered</span>
<span class="comment"># This catches users asking fake "deep" questions to farm</span>
if user.unanswered_ratio > 0.8:
    score *= 0.5
                </div>
            </div>
        </div>

        <table class="comparison">
            <tr>
                <th>Approach</th>
                <th>Traditional</th>
                <th>Bonzi</th>
            </tr>
            <tr>
                <td>Scoring method</td>
                <td class="bad">1 msg = 1 pt</td>
                <td class="good">AI-scored 1-10 pts</td>
            </tr>
            <tr>
                <td>Duplicate detection</td>
                <td class="bad">None</td>
                <td class="good">Semantic similarity</td>
            </tr>
            <tr>
                <td>Gaming resistance</td>
                <td class="bad">Easily farmed</td>
                <td class="good">Cooperation metrics</td>
            </tr>
        </table>

        <p class="manual-link">ğŸ“– <a href="manual/#ask">How to use Ask & Earn â†’</a></p>
    </section>

    <!-- SYBIL DETECTION -->
    <section class="feature-section" id="sybil">
        <div class="feature-header">
            <div class="feature-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/></svg>
            </div>
            <div class="feature-title">
                <h2>Sybil Detection <span class="status-badge live">Live</span></h2>
                <div class="tagline">Flag farmers before the snapshot.</div>
            </div>
        </div>

        <div class="problem-block">
            <div class="block-label">The Problem</div>
            <div class="block-content">
                <p>Airdrops get destroyed by sybils. One person runs 50 wallets, farms 50x the allocation, dumps on real users. Projects lose credibility. Real contributors get diluted.</p>
                <p>Current solutions: manual wallet review (doesn't scale), on-chain analysis (catches some, misses many), trust scores (easily gamed with time).</p>
            </div>
        </div>

        <div class="solution-block">
            <div class="block-label">Our Solution</div>
            <div class="block-content">
                <p>Behavioral analysis across multiple dimensions:</p>
                <ul>
                    <li><strong>AI Fingerprinting</strong> - Detects bot-generated content patterns. ChatGPT summaries, template responses, unnaturally perfect grammar.</li>
                    <li><strong>Temporal Clustering</strong> - Accounts that join within seconds, post at same times, exhibit coordinated behavior.</li>
                    <li><strong>Cross-Tenant Intel</strong> - Patterns seen in one community shared (anonymized) across the network. Farmer caught once = flagged everywhere.</li>
                    <li><strong>Extractive Behavior</strong> - Accounts that only take (claim rewards) but never give (help others). Cooperation ratio near zero.</li>
                </ul>
            </div>
        </div>

        <div class="engineering-block">
            <div class="block-label">Why We Engineered It This Way</div>
            <div class="block-content">
                <p><strong>Behavioral over identity.</strong> Wallet addresses are free. New accounts are free. The only thing farmers can't fake is genuine engagement over time. We measure cooperation, not credentials.</p>
                <p><strong>Cross-tenant sharing.</strong> A farmer might be patient in one community but exposed in another. By sharing behavioral patterns (not personal data), we catch sophisticated actors faster.</p>
                <p><strong>Pre-snapshot flagging.</strong> Most sybil detection happens after the airdrop, when it's too late. We flag suspicious accounts in real-time so projects can act before the snapshot.</p>

                <div class="flow-diagram">
User Activity
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI Fingerprint Check               â”‚
â”‚  Is content bot-generated?          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ Pass
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Temporal Analysis                  â”‚
â”‚  Coordinated with other accounts?   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ Pass
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cooperation Score                  â”‚
â”‚  Helps others or just extracts?     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ Pass
    â–¼
âœ… Legitimate User
                </div>
            </div>
        </div>
    </section>

    <!-- AUTO-MODERATION -->
    <section class="feature-section" id="moderation">
        <div class="feature-header">
            <div class="feature-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="m9 12 2 2 4-4"/></svg>
            </div>
            <div class="feature-title">
                <h2>Auto-Moderation <span class="status-badge live">Live</span></h2>
                <div class="tagline">Questions answered. Spam blocked. You're off the hook.</div>
            </div>
        </div>

        <div class="problem-block">
            <div class="block-label">The Problem</div>
            <div class="block-content">
                <p>Community moderators are <strong>human FAQ machines</strong>. The same questions get asked daily. Mods burn out. Response times suffer. Unanswered questions pile up.</p>
                <p>When mods go offline, spam floods in. When mods are online, they're answering "wen token" for the 500th time instead of building community.</p>
                <p><strong>The escalation trap:</strong> Bots say "I don't know, ask a human." Users DM founders. Founders become the bottleneck.</p>
            </div>
        </div>

        <div class="solution-block">
            <div class="block-label">Our Solution</div>
            <div class="block-content">
                <p>AI that <strong>answers or dead-ends</strong>. Never escalates for answerable questions.</p>
                <ul>
                    <li><strong>Authoritative FAQ</strong> - Known questions get definitive answers, not hedged "I'm not sure" responses.</li>
                    <li><strong>RAG Knowledge Base</strong> - Upload docs, bot answers from them with citations.</li>
                    <li><strong>Spam Blocking</strong> - AI fingerprint detection blocks bot spam before it posts.</li>
                    <li><strong>FUD Rebuttals</strong> - Detects complaint patterns, responds with facts and links.</li>
                    <li><strong>Silence Detection</strong> - Flags when chat goes dead, surfaces engagement metrics.</li>
                </ul>
            </div>
        </div>

        <div class="engineering-block">
            <div class="block-label">Why We Engineered It This Way</div>
            <div class="block-content">
                <p><strong>Definitive answers kill question loops.</strong> When a bot says "I don't have info on that," users escalate to humans. When a bot says "No. Here's why: [facts]" - the question dies. No escalation needed.</p>
                <p><strong>Pattern matching before LLM.</strong> Known questions bypass the LLM entirely. This is faster, cheaper, and more reliable. LLM is fallback for novel questions.</p>
                <p><strong>No "check docs" cop-outs.</strong> If the answer is in the docs, the bot should give the answer, not redirect. Users don't want to read docs. They want answers.</p>

                <div class="flow-diagram">
User Question
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FAQ Pattern Match                  â”‚
â”‚  Known question? â†’ Definitive answerâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ No match
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RAG Retrieval                      â”‚
â”‚  In knowledge base? â†’ Cite source   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ No match
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LLM Generation                     â”‚
â”‚  Generate with anti-hallucination   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ Low confidence
    â–¼
"Not documented. [link to official source]"
    â”‚
    â–¼
STOP (no escalation to humans)
                </div>

                <p><strong>The key insight:</strong> Soft answers ("I'm not sure") create spam. Hard answers ("No, and here's why") end conversations. We optimize for ending conversations correctly, not for appearing helpful while being useless.</p>
            </div>
        </div>

        <table class="comparison">
            <tr>
                <th>Scenario</th>
                <th>Traditional Bot</th>
                <th>Bonzi</th>
            </tr>
            <tr>
                <td>Unknown question</td>
                <td class="bad">"Ask a moderator"</td>
                <td class="good">"Not documented. [link]"</td>
            </tr>
            <tr>
                <td>FAQ question</td>
                <td class="bad">LLM generation (slow, variable)</td>
                <td class="good">Pattern match (instant, consistent)</td>
            </tr>
            <tr>
                <td>Spam/FUD</td>
                <td class="bad">Manual deletion</td>
                <td class="good">Auto-blocked + rebutted</td>
            </tr>
        </table>
    </section>

    <!-- RAID VERIFICATION -->
    <section class="feature-section" id="raid">
        <div class="feature-header">
            <div class="feature-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="4"/><line x1="21.17" y1="8" x2="12" y2="8"/><line x1="3.95" y1="6.06" x2="8.54" y2="14"/><line x1="10.88" y1="21.94" x2="15.46" y2="14"/></svg>
            </div>
            <div class="feature-title">
                <h2>Raid & Earn <span class="status-badge beta">Beta</span></h2>
                <div class="tagline">Auto-verified engagement. No manual review hell.</div>
            </div>
        </div>

        <div class="problem-block">
            <div class="block-label">The Problem</div>
            <div class="block-content">
                <p>Raid campaigns are chaos. Users submit screenshots of their tweets. Mods manually verify each one: Does the tweet exist? Is it original? Is the account real?</p>
                <p>Farmers submit fake screenshots, deleted tweets, copy-pasted content. Mods spend hours on verification instead of strategy.</p>
            </div>
        </div>

        <div class="solution-block">
            <div class="block-label">Our Solution</div>
            <div class="block-content">
                <ul>
                    <li><strong>Tweet Existence Check</strong> - API verification that the tweet URL actually exists and hasn't been deleted.</li>
                    <li><strong>Originality Analysis</strong> - Compare tweet content against known templates and other submissions. Flag copy-paste.</li>
                    <li><strong>Account Quality</strong> - Check account age, follower count, engagement patterns. Bot accounts get flagged.</li>
                    <li><strong>Automatic Scoring</strong> - Good raids get approved instantly. Suspicious ones queued for review.</li>
                </ul>
            </div>
        </div>

        <div class="engineering-block">
            <div class="block-label">Why We Engineered It This Way</div>
            <div class="block-content">
                <p><strong>Verify the source, not the screenshot.</strong> Screenshots can be faked. Tweet URLs can't. We always verify against the actual tweet.</p>
                <p><strong>Originality over quantity.</strong> 100 copy-paste raids are worth less than 10 original ones. We score for creativity and genuine engagement.</p>
                <p><strong>Tiered verification.</strong> Trusted users get fast-tracked. New users get extra scrutiny. This balances speed with security.</p>
            </div>
        </div>

        <p class="manual-link">ğŸ“– <a href="manual/#quickstart">How to join raids â†’</a></p>
    </section>

    <!-- THANKS SYSTEM -->
    <section class="feature-section" id="thanks">
        <div class="feature-header">
            <div class="feature-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>
            </div>
            <div class="feature-title">
                <h2>Thanks System <span class="status-badge live">Live</span></h2>
                <div class="tagline">Peer recognition that counts.</div>
            </div>
        </div>

        <div class="problem-block">
            <div class="block-label">The Problem</div>
            <div class="block-content">
                <p>Helpful community members go unrecognized. Someone answers questions all day, gets nothing. Someone posts one meme, goes viral. Recognition is random.</p>
            </div>
        </div>

        <div class="solution-block">
            <div class="block-label">Our Solution</div>
            <div class="block-content">
                <p>React to any helpful post with a designated emoji. The author gets +1 point. Simple, visible, trackable.</p>
                <ul>
                    <li><strong>Peer-to-peer</strong> - Recognition comes from community, not mods.</li>
                    <li><strong>On-chain ready</strong> - Points tracked in database, exportable for airdrops.</li>
                    <li><strong>Anti-gaming</strong> - Can't thank yourself. Rate-limited per user. Patterns detected.</li>
                </ul>
            </div>
        </div>

        <p class="manual-link">ğŸ“– <a href="manual/#thanks">How to thank someone â†’</a></p>
    </section>

    <!-- CTA -->
    <section class="cta-section">
        <h2>Ready to automate your community?</h2>
        <p>Self-host free, or let us run it for you.</p>
        <a href="index.html#demo" class="cta-btn">Try the Demo</a>
    </section>

    <footer>
        <p>Built by <a href="https://defiants.org">Defiants.org</a>. Open source. Not for profit.</p>
        <p style="margin-top: 8px;"><a href="index.html">Home</a> &middot; <a href="privacy.html">Privacy</a> &middot; <a href="https://github.com/Siah-kin/community-bot">GitHub</a></p>
    </footer>

    <!-- Sound Toggle + Hint -->
    <div class="sound-hint" id="sound-hint">
        <span class="emoji">ğŸ’œ</span>
        <span class="emoji">ğŸ¤«</span>
        <span class="arrow">â–¼</span>
    </div>
    <button class="sound-toggle muted" id="sound-toggle" aria-label="Toggle sound">
        <svg class="sound-on" viewBox="0 0 24 24" fill="currentColor">
            <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
        </svg>
        <svg class="sound-off" viewBox="0 0 24 24" fill="currentColor">
            <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
        </svg>
    </button>
    <audio id="bg-music" preload="auto"></audio>

    <script>
        // Theme toggle - persist night mode across pages
        const themeToggle = document.getElementById('theme-toggle');
        const savedTheme = localStorage.getItem('bonzi_theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
        }
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            localStorage.setItem('bonzi_theme', isDark ? 'dark' : 'light');
        });

        function toggleMenu() {
            document.querySelector('.hamburger').classList.toggle('active');
            document.querySelector('.nav-links').classList.toggle('active');
        }
        function closeMenu() {
            document.querySelector('.hamburger').classList.remove('active');
            document.querySelector('.nav-links').classList.remove('active');
        }

        // Resume Moby from homepage - "room effect" (lower volume like hearing from another room)
        const bgMusic = document.getElementById('bg-music');
        const soundToggle = document.getElementById('sound-toggle');
        let isMuted = true;
        const roomVolume = 0.12; // Distant room effect - quieter than main page
        let targetVolume = roomVolume;

        // Smooth volume transitions
        function fadeToVolume(target, duration = 800) {
            const startVol = bgMusic.volume;
            const diff = target - startVol;
            const startTime = performance.now();

            function animate(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                // Ease out cubic for smooth fade
                const eased = 1 - Math.pow(1 - progress, 3);
                bgMusic.volume = startVol + (diff * eased);
                if (progress < 1) requestAnimationFrame(animate);
            }
            requestAnimationFrame(animate);
        }

        function checkResumeAudio() {
            const saved = localStorage.getItem('bonzi_audio');
            if (saved) {
                const state = JSON.parse(saved);
                if (state.track === 'moby') {
                    bgMusic.src = 'moby-god-moving.mp3';
                    bgMusic.currentTime = state.time || 0;
                    bgMusic.loop = true;
                    bgMusic.volume = 0;
                    isMuted = false;
                    soundToggle.classList.remove('muted');
                    bgMusic.play().catch(e => {});
                    // Fade down to room volume (coming from louder main page)
                    fadeToVolume(roomVolume, 1200);
                }
                localStorage.removeItem('bonzi_audio');
            }
        }
        checkResumeAudio();

        const soundHint = document.getElementById('sound-hint');

        soundToggle.addEventListener('click', () => {
            isMuted = !isMuted;
            soundToggle.classList.toggle('muted', isMuted);
            if (soundHint) soundHint.style.display = 'none';
            if (isMuted) {
                fadeToVolume(0, 400);
            } else {
                if (!bgMusic.src || bgMusic.src === '') {
                    bgMusic.src = 'moby-god-moving.mp3';
                    bgMusic.loop = true;
                    bgMusic.volume = 0;
                }
                bgMusic.play().catch(e => {});
                fadeToVolume(roomVolume, 600);
            }
        });

        // Hide hint after 5 seconds
        if (soundHint) {
            setTimeout(() => {
                soundHint.style.opacity = '0';
                setTimeout(() => soundHint.style.display = 'none', 500);
            }, 5000);
        }

        // Save state before leaving (save full volume so main page knows to fade up)
        window.addEventListener('beforeunload', () => {
            if (!isMuted) {
                localStorage.setItem('bonzi_audio', JSON.stringify({
                    track: 'moby',
                    time: bgMusic.currentTime,
                    volume: 0.3 // Store the "main room" volume for return trip
                }));
            }
        });

        // Nav Connect Button Handler
        (function() {
            const navBtn = document.getElementById('nav-connect-btn');
            if (!navBtn) return;
            function truncateAddress(addr) { return addr.slice(0, 6) + '...' + addr.slice(-4); }
            function updateButtonState() {
                const savedWallet = localStorage.getItem('bonzi_wallet_address');
                const savedTimestamp = localStorage.getItem('bonzi_auth_timestamp');
                if (savedWallet && savedTimestamp) {
                    const age = Date.now() - parseInt(savedTimestamp);
                    if (age < 24 * 60 * 60 * 1000) {
                        navBtn.textContent = truncateAddress(savedWallet);
                        navBtn.classList.add('connected');
                        return true;
                    }
                }
                return false;
            }
            async function handleConnect() {
                if (updateButtonState()) { window.location.href = 'research/'; return; }
                if (typeof window.ethereum === 'undefined') { alert('Please install MetaMask or another Web3 wallet'); return; }
                const originalText = navBtn.textContent;
                navBtn.textContent = 'Connecting...';
                navBtn.disabled = true;
                // Timeout helper - 45 second max wait
                const withTimeout = (promise, ms = 45000) => Promise.race([
                    promise,
                    new Promise((_, reject) => setTimeout(() => reject(new Error('Connection timed out')), ms))
                ]);
                try {
                    const accounts = await withTimeout(window.ethereum.request({ method: 'eth_requestAccounts' }));
                    if (accounts && accounts.length > 0) {
                        localStorage.setItem('bonzi_wallet_address', accounts[0]);
                        localStorage.setItem('bonzi_auth_timestamp', Date.now().toString());
                        navBtn.textContent = truncateAddress(accounts[0]);
                        navBtn.classList.add('connected');
                    }
                } catch (err) {
                    console.error('Wallet connection failed:', err);
                    navBtn.textContent = originalText;
                    navBtn.disabled = false;
                }
            }
            updateButtonState();
            navBtn.addEventListener('click', handleConnect);
        })();
    </script>
</body>
</html>
